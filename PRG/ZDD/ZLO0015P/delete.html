<!DOCTYPE html>
<html lang="es">
  <head>
  <meta name="google" content="notranslate">
  <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Lovable </title>
    <link rel="icon" type="image/x-icon" href="../../../assets/img/favicon.ico">
    <link rel="stylesheet" href="../../../assets/vendors/simplebar/css/simplebar.css">
    <link rel="stylesheet" href="../../../assets/css/vendors/simplebar.css">
    <link href="../../../assets/css/style.css" rel="stylesheet">
    <link href="../../../assets/css/examples.css" rel="stylesheet">
    <link href="../../../assets/css/mystyle.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      $(document).ready(function(){
        const currentUrl = window.location.href;
            var url = new URL(currentUrl);
            var user= url.searchParams.get("user");
            var cor= url.searchParams.get("cor");
            var cia=""; var prv=""; var tip=""; var doc=""; var apl=""; var docf=""; var fec=""; var tienda=""; var descrp="";   
            if (cor) {
             var paramsLength=""; var paramsData=[];
            cor=url.searchParams.get("cor");
                var getParamsurl="http://172.16.15.20/API.LovablePHP/ZLO0015P/GetParams2/?cod="+cor+"";
                var responseParams = ajaxRequest(getParamsurl);
            if (responseParams.code==200){
                paramsData=responseParams.data;
                paramsLength=paramsData['LENGTH'];
                var camposLength=paramsLength-5;
                fec=paramsData['FECDOC'];
                apl=paramsData['MODULO'];
                tip=paramsData['TIPWEB'];
                var validator=false;
                for (let i = 0; i < camposLength; i++) {
                cia=paramsData['CAM1'].split(':')[1];
                if (paramsData['CAM'+(i+1)].split(':')[1].includes('-') && paramsData['CAM'+(i+1)].split(':')[1].length==7) {
                  validator=true;
                  prv=paramsData['CAM'+(i+1)].split(':')[1];
                }
                if (validator) {
                  tienda=paramsData['CAM2'].split(':')[1];
                  doc=paramsData['CAM5'].split(':')[1];
                }else{
                  doc=paramsData['CAM4'].split(':')[1];
                }

                }
            } 
           }
            var urlDelete="http://172.16.15.20/API.LovablePHP/ZLO0016P/DeleteAS400/?apl="+apl+"&tip="+tip+"&cia="+cia+"&prv="+prv+"&doc="+doc+"&tie="+tienda+"";
            console.log(urlDelete);
            var response=ajaxRequest(urlDelete);
            if (response.code==200) {
              $("#lblMessage").text("El documento fue eliminado exitosamente.");
              $("#lblMessage").addClass("text-success");
            }else{
              $("#lblMessage").text("El documento no fue encontrado, verifique.");
              $("#lblMessage").addClass("text-danger");
            }
      });

      function ajaxRequest(url, data = {}, method = "GET") {
                var dataResponse = null;
                var Token = null;
                var HTTPError = {
                    message: '',
                    code: 0,
                    success: false,
                    data: null
                };
                $.ajax({
                    url: url,
                    data: JSON.stringify(data),
                    method: method,
                    dataType: "json",
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    async: false,
                    success: function(response) {
                        dataResponse = response;
                    },
                });
                return dataResponse;
            }
    </script>
  </head>
  <body>
    <div class="bg-light min-vh-100 d-flex flex-row align-items-center">
      <div class="container">
        <div class="d-flex justify-content-center">
          <div>
              <img src="../../../assets/img/lovableLogo.png" alt="Lovable-logo" width="350">
            </div>
              <div>
                <h2 class="pt-3 ms-2 mt-1">Proceso de digitalizaci√≥n de documentos</h2>
                <p class="fs-4 ms-2 fw-bold" id="lblMessage"></p>
              </div>
        </div>
      </div>
    </div>
    <script src="../../../assets/vendors/@coreui/coreui/js/coreui.bundle.min.js"></script>
    <script src="../../../assets/vendors/simplebar/js/simplebar.min.js"></script>
  </body>
</html>