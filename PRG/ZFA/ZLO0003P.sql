SELECT HON.MARCA MARCA,HON.DESDES DESDES,HON.CANANO1 CANHON,HON.VALANO1 VALHON,HON.CANANO2 CANHON2,HON.VALANO2 VALHON2,
 GUA.CANANO1 CANGUA,GUA.VALANO1 VALGUA,GUA.CANANO2 CANGUA2,GUA.VALANO2 VALGUA2,
 SAL.CANANO1 CANSAL,SAL.VALANO1 VALSAL,SAL.CANANO2 CANSAL2,SAL.VALANO2 VALSAL2,
 COS.CANANO1 CANCOS,COS.VALANO1 VALCOS,COS.CANANO2 CANCOS2,COS.VALANO2 VALCOS2,
 REP.CANANO1 CANREP,REP.VALANO1 VALREP,REP.CANANO2 CANREP2,REP.VALANO2 VALREP2,
 NIC.CANANO1 CANNIC,NIC.VALANO1 VALNIC,NIC.CANANO2 CANNIC2,NIC.VALANO2 VALNIC2
 FROM(SELECT ANO1.MARCA,ANO1.DESDES,ANO1.CANANO1 CANANO1, ANO1.VALANO1 VALANO1,ANO2.VALANO1 VALANO2, ANO2.CANANO1 CANANO2 FROM(
            SELECT MARCA,DESDES,SUM(CANANO1) CANANO1,SUM(VALANO1) VALANO1 FROM(
            SELECT ANO1.MARCA MARCA,ANO1.DESDES,ANO1.CANTIDAD CANANO1,ANO1.VALOR VALANO1 FROM (SELECT CODCIA,MARCA,DESDES,FLOOR(((FLOOR(CANTIDAD)*12) +ROUND((CANTIDAD - FLOOR(CANTIDAD)) * 100))) CANTIDAD, VALOR FROM (SELECT CODCIA,MARCA, MAX(DESDES) as DESDES, SUM(CANVEN) CANTIDAD, SUM(VALVEN) VALOR FROM (SELECT CODCIA, MARCA, CANVEN, VALVEN FROM LBPRDDAT/lo2234 WHERE ANOPRO=".($ano2)." AND MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." AND CODCIA IN (35,47,50,52,56,57,59,63,64,65,68,70,72,73,74,75,76,78,82,85,88,90)) T1 INNER JOIN LBPRDDAT/DESARC T2 ON T1.MARCA=T2.DESCO1 AND T2.DESCOD=1 GROUP BY CODCIA,MARCA))ANO1  ) GROUP BY MARCA,DESDES) AS ANO1
            INNER JOIN(SELECT MARCA,DESDES,SUM(CANANO1) CANANO1,SUM(VALANO1) VALANO1 FROM(
            SELECT ANO1.MARCA MARCA,ANO1.DESDES,ANO1.CANTIDAD CANANO1,ANO1.VALOR VALANO1 FROM (SELECT CODCIA,MARCA,DESDES,FLOOR(((FLOOR(CANTIDAD)*12) +ROUND((CANTIDAD - FLOOR(CANTIDAD)) * 100))) CANTIDAD, VALOR FROM (SELECT CODCIA,MARCA, MAX(DESDES) as DESDES, SUM(CANVEN) CANTIDAD, SUM(VALVEN) VALOR FROM (SELECT CODCIA, MARCA, CANVEN, VALVEN FROM LBPRDDAT/lo2234 WHERE ANOPRO=".($ano2-1)." AND MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." AND CODCIA IN (35,47,50,52,56,57,59,63,64,65,68,70,72,73,74,75,76,78,82,85,88,90)) T1 INNER JOIN LBPRDDAT/DESARC T2 ON T1.MARCA=T2.DESCO1 AND T2.DESCOD=1 GROUP BY CODCIA,MARCA))ANO1  ) GROUP BY MARCA,DESDES) AS ANO2
            ON ANO1.MARCA=ANO2.MARCA AND ANO1.DESDES =ANO2.DESDES) HON LEFT JOIN
(SELECT ANO1.MARCA,ANO1.DESDES,ANO1.CANANO1 CANANO1, ANO1.VALANO1 VALANO1,ANO2.VALANO1 VALANO2, ANO2.CANANO1 CANANO2 FROM(
            SELECT MARCA,DESDES,SUM(CANANO1) CANANO1,SUM(VALANO1) VALANO1 FROM(
            SELECT ANO1.MARCA MARCA,ANO1.DESDES,ANO1.CANTIDAD CANANO1,ANO1.VALOR VALANO1 FROM (SELECT CODCIA,MARCA,DESDES,FLOOR(((FLOOR(CANTIDAD)*12) +ROUND((CANTIDAD - FLOOR(CANTIDAD)) * 100))) CANTIDAD, VALOR FROM (SELECT CODCIA,MARCA, MAX(DESDES) as DESDES, SUM(CANVEN) CANTIDAD, SUM(VALVEN) VALOR FROM (SELECT CODCIA, MARCA, CANVEN, VALVEN FROM LBPRDDAT/lo2234 WHERE ANOPRO=".($ano2)." AND MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." AND CODCIA IN  (49,66,69,71,86,89)) T1 INNER JOIN LBPRDDAT/DESARC T2 ON T1.MARCA=T2.DESCO1 AND T2.DESCOD=1 GROUP BY CODCIA,MARCA))ANO1  ) GROUP BY MARCA,DESDES) AS ANO1
            INNER JOIN(SELECT MARCA,DESDES,SUM(CANANO1) CANANO1,SUM(VALANO1) VALANO1 FROM(
            SELECT ANO1.MARCA MARCA,ANO1.DESDES,ANO1.CANTIDAD CANANO1,ANO1.VALOR VALANO1 FROM (SELECT CODCIA,MARCA,DESDES,FLOOR(((FLOOR(CANTIDAD)*12) +ROUND((CANTIDAD - FLOOR(CANTIDAD)) * 100))) CANTIDAD, VALOR FROM (SELECT CODCIA,MARCA, MAX(DESDES) as DESDES, SUM(CANVEN) CANTIDAD, SUM(VALVEN) VALOR FROM (SELECT CODCIA, MARCA, CANVEN, VALVEN FROM LBPRDDAT/lo2234 WHERE ANOPRO=".($ano2-1)." AND MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." AND CODCIA IN  (49,66,69,71,86,89)) T1 INNER JOIN LBPRDDAT/DESARC T2 ON T1.MARCA=T2.DESCO1 AND T2.DESCOD=1 GROUP BY CODCIA,MARCA))ANO1  ) GROUP BY MARCA,DESDES) AS ANO2
            ON ANO1.MARCA=ANO2.MARCA AND ANO1.DESDES =ANO2.DESDES)GUA ON HON.MARCA=GUA.MARCA LEFT JOIN
(SELECT ANO1.MARCA,ANO1.DESDES,ANO1.CANANO1 CANANO1, ANO1.VALANO1 VALANO1,ANO2.VALANO1 VALANO2, ANO2.CANANO1 CANANO2 FROM(
            SELECT MARCA,DESDES,SUM(CANANO1) CANANO1,SUM(VALANO1) VALANO1 FROM(
            SELECT ANO1.MARCA MARCA,ANO1.DESDES,ANO1.CANTIDAD CANANO1,ANO1.VALOR VALANO1 FROM (SELECT CODCIA,MARCA,DESDES,FLOOR(((FLOOR(CANTIDAD)*12) +ROUND((CANTIDAD - FLOOR(CANTIDAD)) * 100))) CANTIDAD, VALOR FROM (SELECT CODCIA,MARCA, MAX(DESDES) as DESDES, SUM(CANVEN) CANTIDAD, SUM(VALVEN) VALOR FROM (SELECT CODCIA, MARCA, CANVEN, VALVEN FROM LBPRDDAT/lo2234 WHERE ANOPRO=".($ano2)." AND MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." AND CODCIA IN (48,53,61,62,77)) T1 INNER JOIN LBPRDDAT/DESARC T2 ON T1.MARCA=T2.DESCO1 AND T2.DESCOD=1 GROUP BY CODCIA,MARCA))ANO1  ) GROUP BY MARCA,DESDES) AS ANO1
            INNER JOIN(SELECT MARCA,DESDES,SUM(CANANO1) CANANO1,SUM(VALANO1) VALANO1 FROM(
            SELECT ANO1.MARCA MARCA,ANO1.DESDES,ANO1.CANTIDAD CANANO1,ANO1.VALOR VALANO1 FROM (SELECT CODCIA,MARCA,DESDES,FLOOR(((FLOOR(CANTIDAD)*12) +ROUND((CANTIDAD - FLOOR(CANTIDAD)) * 100))) CANTIDAD, VALOR FROM (SELECT CODCIA,MARCA, MAX(DESDES) as DESDES, SUM(CANVEN) CANTIDAD, SUM(VALVEN) VALOR FROM (SELECT CODCIA, MARCA, CANVEN, VALVEN FROM LBPRDDAT/lo2234 WHERE ANOPRO=".($ano2-1)." AND MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." AND CODCIA IN (48,53,61,62,77)) T1 INNER JOIN LBPRDDAT/DESARC T2 ON T1.MARCA=T2.DESCO1 AND T2.DESCOD=1 GROUP BY CODCIA,MARCA))ANO1  ) GROUP BY MARCA,DESDES) AS ANO2
            ON ANO1.MARCA=ANO2.MARCA AND ANO1.DESDES =ANO2.DESDES)SAL ON HON.MARCA=SAL.MARCA LEFT JOIN
(SELECT ANO1.MARCA,ANO1.DESDES,ANO1.CANANO1 CANANO1, ANO1.VALANO1 VALANO1,ANO2.VALANO1 VALANO2, ANO2.CANANO1 CANANO2 FROM(
            SELECT MARCA,DESDES,SUM(CANANO1) CANANO1,SUM(VALANO1) VALANO1 FROM(
            SELECT ANO1.MARCA MARCA,ANO1.DESDES,ANO1.CANTIDAD CANANO1,ANO1.VALOR VALANO1 FROM (SELECT CODCIA,MARCA,DESDES,FLOOR(((FLOOR(CANTIDAD)*12) +ROUND((CANTIDAD - FLOOR(CANTIDAD)) * 100))) CANTIDAD, VALOR FROM (SELECT CODCIA,MARCA, MAX(DESDES) as DESDES, SUM(CANVEN) CANTIDAD, SUM(VALVEN) VALOR FROM (SELECT CODCIA, MARCA, CANVEN, VALVEN FROM LBPRDDAT/lo2234 WHERE ANOPRO=".($ano2)." AND MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." AND CODCIA IN (54,60,80)) T1 INNER JOIN LBPRDDAT/DESARC T2 ON T1.MARCA=T2.DESCO1 AND T2.DESCOD=1 GROUP BY CODCIA,MARCA))ANO1  ) GROUP BY MARCA,DESDES) AS ANO1
            INNER JOIN(SELECT MARCA,DESDES,SUM(CANANO1) CANANO1,SUM(VALANO1) VALANO1 FROM(
            SELECT ANO1.MARCA MARCA,ANO1.DESDES,ANO1.CANTIDAD CANANO1,ANO1.VALOR VALANO1 FROM (SELECT CODCIA,MARCA,DESDES,FLOOR(((FLOOR(CANTIDAD)*12) +ROUND((CANTIDAD - FLOOR(CANTIDAD)) * 100))) CANTIDAD, VALOR FROM (SELECT CODCIA,MARCA, MAX(DESDES) as DESDES, SUM(CANVEN) CANTIDAD, SUM(VALVEN) VALOR FROM (SELECT CODCIA, MARCA, CANVEN, VALVEN FROM LBPRDDAT/lo2234 WHERE ANOPRO=".($ano2-1)." AND MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." AND CODCIA IN (54,60,80)) T1 INNER JOIN LBPRDDAT/DESARC T2 ON T1.MARCA=T2.DESCO1 AND T2.DESCOD=1 GROUP BY CODCIA,MARCA))ANO1  ) GROUP BY MARCA,DESDES) AS ANO2
            ON ANO1.MARCA=ANO2.MARCA AND ANO1.DESDES =ANO2.DESDES)COS ON HON.MARCA=COS.MARCA LEFT JOIN
(SELECT ANO1.MARCA,ANO1.DESDES,ANO1.CANANO1 CANANO1, ANO1.VALANO1 VALANO1,ANO2.VALANO1 VALANO2, ANO2.CANANO1 CANANO2 FROM(
            SELECT MARCA,DESDES,SUM(CANANO1) CANANO1,SUM(VALANO1) VALANO1 FROM(
            SELECT ANO1.MARCA MARCA,ANO1.DESDES,ANO1.CANTIDAD CANANO1,ANO1.VALOR VALANO1 FROM (SELECT CODCIA,MARCA,DESDES,FLOOR(((FLOOR(CANTIDAD)*12) +ROUND((CANTIDAD - FLOOR(CANTIDAD)) * 100))) CANTIDAD, VALOR FROM (SELECT CODCIA,MARCA, MAX(DESDES) as DESDES, SUM(CANVEN) CANTIDAD, SUM(VALVEN) VALOR FROM (SELECT CODCIA, MARCA, CANVEN, VALVEN FROM LBPRDDAT/lo2234 WHERE ANOPRO=".($ano2)." AND MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." AND CODCIA IN (83,87)) T1 INNER JOIN LBPRDDAT/DESARC T2 ON T1.MARCA=T2.DESCO1 AND T2.DESCOD=1 GROUP BY CODCIA,MARCA))ANO1  ) GROUP BY MARCA,DESDES) AS ANO1
            INNER JOIN(SELECT MARCA,DESDES,SUM(CANANO1) CANANO1,SUM(VALANO1) VALANO1 FROM(
            SELECT ANO1.MARCA MARCA,ANO1.DESDES,ANO1.CANTIDAD CANANO1,ANO1.VALOR VALANO1 FROM (SELECT CODCIA,MARCA,DESDES,FLOOR(((FLOOR(CANTIDAD)*12) +ROUND((CANTIDAD - FLOOR(CANTIDAD)) * 100))) CANTIDAD, VALOR FROM (SELECT CODCIA,MARCA, MAX(DESDES) as DESDES, SUM(CANVEN) CANTIDAD, SUM(VALVEN) VALOR FROM (SELECT CODCIA, MARCA, CANVEN, VALVEN FROM LBPRDDAT/lo2234 WHERE ANOPRO=".($ano2-1)." AND MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." AND CODCIA IN (83,87)) T1 INNER JOIN LBPRDDAT/DESARC T2 ON T1.MARCA=T2.DESCO1 AND T2.DESCOD=1 GROUP BY CODCIA,MARCA))ANO1  ) GROUP BY MARCA,DESDES) AS ANO2
            ON ANO1.MARCA=ANO2.MARCA AND ANO1.DESDES =ANO2.DESDES)NIC ON HON.MARCA=NIC.MARCA LEFT JOIN
(SELECT ANO1.MARCA,ANO1.DESDES,ANO1.CANANO1 CANANO1, ANO1.VALANO1 VALANO1,ANO2.VALANO1 VALANO2, ANO2.CANANO1 CANANO2 FROM(
            SELECT MARCA,DESDES,SUM(CANANO1) CANANO1,SUM(VALANO1) VALANO1 FROM(
            SELECT ANO1.MARCA MARCA,ANO1.DESDES,ANO1.CANTIDAD CANANO1,ANO1.VALOR VALANO1 FROM (SELECT CODCIA,MARCA,DESDES,FLOOR(((FLOOR(CANTIDAD)*12) +ROUND((CANTIDAD - FLOOR(CANTIDAD)) * 100))) CANTIDAD, VALOR FROM (SELECT CODCIA,MARCA, MAX(DESDES) as DESDES, SUM(CANVEN) CANTIDAD, SUM(VALVEN) VALOR FROM (SELECT CODCIA, MARCA, CANVEN, VALVEN FROM LBPRDDAT/lo2234 WHERE ANOPRO=".($ano2)." AND MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." AND CODCIA IN (81,91)) T1 INNER JOIN LBPRDDAT/DESARC T2 ON T1.MARCA=T2.DESCO1 AND T2.DESCOD=1 GROUP BY CODCIA,MARCA))ANO1  ) GROUP BY MARCA,DESDES) AS ANO1
            INNER JOIN(SELECT MARCA,DESDES,SUM(CANANO1) CANANO1,SUM(VALANO1) VALANO1 FROM(
            SELECT ANO1.MARCA MARCA,ANO1.DESDES,ANO1.CANTIDAD CANANO1,ANO1.VALOR VALANO1 FROM (SELECT CODCIA,MARCA,DESDES,FLOOR(((FLOOR(CANTIDAD)*12) +ROUND((CANTIDAD - FLOOR(CANTIDAD)) * 100))) CANTIDAD, VALOR FROM (SELECT CODCIA,MARCA, MAX(DESDES) as DESDES, SUM(CANVEN) CANTIDAD, SUM(VALVEN) VALOR FROM (SELECT CODCIA, MARCA, CANVEN, VALVEN FROM LBPRDDAT/lo2234 WHERE ANOPRO=".($ano2-1)." AND MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." AND CODCIA IN (81,91)) T1 INNER JOIN LBPRDDAT/DESARC T2 ON T1.MARCA=T2.DESCO1 AND T2.DESCOD=1 GROUP BY CODCIA,MARCA))ANO1  ) GROUP BY MARCA,DESDES) AS ANO2
            ON ANO1.MARCA=ANO2.MARCA AND ANO1.DESDES =ANO2.DESDES)REP ON HON.MARCA=REP.MARCA







//
SELECT HON.MARCA MARCA,HON.DESDES DESDES,HON.CANANO1 CANHON,HON.VALANO1 VALHON,HON.CANANO2 CANHON2,HON.VALANO2 VALHON2,
GUA.CANANO1 CANGUA,GUA.VALANO1 VALGUA,GUA.CANANO2 CANGUA2,GUA.VALANO2 VALGUA2,
 SAL.CANANO1 CANSAL,SAL.VALANO1 VALSAL,SAL.CANANO2 CANSAL2,SAL.VALANO2 VALSAL2,
 COS.CANANO1 CANCOS,COS.VALANO1 VALCOS,COS.CANANO2 CANCOS2,COS.VALANO2 VALCOS2,
 REP.CANANO1 CANREP,REP.VALANO1 VALREP,REP.CANANO2 CANREP2,REP.VALANO2 VALREP2,
 NIC.CANANO1 CANNIC,NIC.VALANO1 VALNIC,NIC.CANANO2 CANNIC2,NIC.VALANO2 VALNIC2
FROM(
SELECT ANO1.MARCA,ANO1.DESDES,ANO1.CANVEN AS CANANO1, ANO1.VALVEN AS VALANO1, ANO2.CANVEN AS CANANO2, ANO2.VALVEN AS VALANO2 FROM (SELECT DESCO1 AS MARCA,DESDES, SUM(CANVEN) AS CANVEN, SUM(VALVEN) AS VALVEN FROM (SELECT DESCO1,DESDES, COALESCE(CANVEN,0) AS CANVEN, COALESCE(VALVEN,0) AS VALVEN FROM LBPRDDAT/DESARC AS DESTABLA LEFT JOIN (SELECT T2.CODCIA, T2.ANOPRO, T2.MESPRO, T2.MARCA, T2.CANVEN,T2.VALVEN FROM LBPRDDAT/LO0703 AS T1 INNER JOIN LBPRDDAT/LO2234 AS T2 ON T1.CODCIA=T2.CODCIA WHERE T1.CODIGO=11 AND T2.ANOPRO=".($ano2)." AND T2.MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." ORDER BY T2.MESPRO ) AS VENTABLA ON DESTABLA.DESCO1=VENTABLA.MARCA WHERE DESCOD=1 AND DESCO1<=950) AS T GROUP BY DESCO1,DESDES ORDER BY DESCO1) AS ANO1 INNER JOIN (SELECT DESCO1 AS MARCA,DESDES, SUM(CANVEN) AS CANVEN, SUM(VALVEN) AS VALVEN FROM (SELECT DESCO1,DESDES, COALESCE(CANVEN,0) AS CANVEN, COALESCE(VALVEN,0) AS VALVEN FROM LBPRDDAT/DESARC AS DESTABLA LEFT JOIN (SELECT T2.CODCIA, T2.ANOPRO, T2.MESPRO, T2.MARCA, T2.CANVEN,T2.VALVEN FROM LBPRDDAT/LO0703 AS T1 INNER JOIN LBPRDDAT/LO2234 AS T2 ON T1.CODCIA=T2.CODCIA WHERE T1.CODIGO=11 AND T2.ANOPRO=".($ano2-1)." AND T2.MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." ORDER BY T2.MESPRO ) AS VENTABLA ON DESTABLA.DESCO1=VENTABLA.MARCA WHERE DESCOD=1 AND DESCO1<=950) AS T GROUP BY DESCO1,DESDES ORDER BY DESCO1) AS ANO2 ON ANO1.MARCA = ANO2.MARCA AND ANO1.DESDES = ANO2.DESDES
) AS HON
INNER JOIN (
SELECT ANO1.MARCA,ANO1.DESDES,ANO1.CANVEN AS CANANO1, ANO1.VALVEN AS VALANO1, ANO2.CANVEN AS CANANO2, ANO2.VALVEN AS VALANO2 FROM (SELECT DESCO1 AS MARCA,DESDES, SUM(CANVEN) AS CANVEN, SUM(VALVEN) AS VALVEN FROM (SELECT DESCO1,DESDES, COALESCE(CANVEN,0) AS CANVEN, COALESCE(VALVEN,0) AS VALVEN FROM LBPRDDAT/DESARC AS DESTABLA LEFT JOIN (SELECT T2.CODCIA, T2.ANOPRO, T2.MESPRO, T2.MARCA, T2.CANVEN,T2.VALVEN FROM LBPRDDAT/LO0703 AS T1 INNER JOIN LBPRDDAT/LO2234 AS T2 ON T1.CODCIA=T2.CODCIA WHERE T1.CODIGO=10 AND T2.ANOPRO=".($ano2)." AND T2.MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." ORDER BY T2.MESPRO ) AS VENTABLA ON DESTABLA.DESCO1=VENTABLA.MARCA WHERE DESCOD=1 AND DESCO1<=950) AS T GROUP BY DESCO1,DESDES ORDER BY DESCO1) AS ANO1 INNER JOIN (SELECT DESCO1 AS MARCA,DESDES, SUM(CANVEN) AS CANVEN, SUM(VALVEN) AS VALVEN FROM (SELECT DESCO1,DESDES, COALESCE(CANVEN,0) AS CANVEN, COALESCE(VALVEN,0) AS VALVEN FROM LBPRDDAT/DESARC AS DESTABLA LEFT JOIN (SELECT T2.CODCIA, T2.ANOPRO, T2.MESPRO, T2.MARCA, T2.CANVEN,T2.VALVEN FROM LBPRDDAT/LO0703 AS T1 INNER JOIN LBPRDDAT/LO2234 AS T2 ON T1.CODCIA=T2.CODCIA WHERE T1.CODIGO=10 AND T2.ANOPRO=".($ano2-1)." AND T2.MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." ORDER BY T2.MESPRO ) AS VENTABLA ON DESTABLA.DESCO1=VENTABLA.MARCA WHERE DESCOD=1 AND DESCO1<=950) AS T GROUP BY DESCO1,DESDES ORDER BY DESCO1) AS ANO2 ON ANO1.MARCA = ANO2.MARCA AND ANO1.DESDES = ANO2.DESDES
) AS GUA ON HON.MARCA = GUA.MARCA
INNER JOIN (
SELECT ANO1.MARCA,ANO1.DESDES,ANO1.CANVEN AS CANANO1, ANO1.VALVEN AS VALANO1, ANO2.CANVEN AS CANANO2, ANO2.VALVEN AS VALANO2 FROM (SELECT DESCO1 AS MARCA,DESDES, SUM(CANVEN) AS CANVEN, SUM(VALVEN) AS VALVEN FROM (SELECT DESCO1,DESDES, COALESCE(CANVEN,0) AS CANVEN, COALESCE(VALVEN,0) AS VALVEN FROM LBPRDDAT/DESARC AS DESTABLA LEFT JOIN (SELECT T2.CODCIA, T2.ANOPRO, T2.MESPRO, T2.MARCA, T2.CANVEN,T2.VALVEN FROM LBPRDDAT/LO0703 AS T1 INNER JOIN LBPRDDAT/LO2234 AS T2 ON T1.CODCIA=T2.CODCIA WHERE T1.CODIGO=12 AND T2.ANOPRO=".($ano2)." AND T2.MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." ORDER BY T2.MESPRO ) AS VENTABLA ON DESTABLA.DESCO1=VENTABLA.MARCA WHERE DESCOD=1 AND DESCO1<=950) AS T GROUP BY DESCO1,DESDES ORDER BY DESCO1) AS ANO1 INNER JOIN (SELECT DESCO1 AS MARCA,DESDES, SUM(CANVEN) AS CANVEN, SUM(VALVEN) AS VALVEN FROM (SELECT DESCO1,DESDES, COALESCE(CANVEN,0) AS CANVEN, COALESCE(VALVEN,0) AS VALVEN FROM LBPRDDAT/DESARC AS DESTABLA LEFT JOIN (SELECT T2.CODCIA, T2.ANOPRO, T2.MESPRO, T2.MARCA, T2.CANVEN,T2.VALVEN FROM LBPRDDAT/LO0703 AS T1 INNER JOIN LBPRDDAT/LO2234 AS T2 ON T1.CODCIA=T2.CODCIA WHERE T1.CODIGO=12 AND T2.ANOPRO=".($ano2-1)." AND T2.MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." ORDER BY T2.MESPRO ) AS VENTABLA ON DESTABLA.DESCO1=VENTABLA.MARCA WHERE DESCOD=1 AND DESCO1<=950) AS T GROUP BY DESCO1,DESDES ORDER BY DESCO1) AS ANO2 ON ANO1.MARCA = ANO2.MARCA AND ANO1.DESDES = ANO2.DESDES
) AS SAL ON HON.MARCA = SAL.MARCA
INNER JOIN (
SELECT ANO1.MARCA,ANO1.DESDES,ANO1.CANVEN AS CANANO1, ANO1.VALVEN AS VALANO1, ANO2.CANVEN AS CANANO2, ANO2.VALVEN AS VALANO2 FROM (SELECT DESCO1 AS MARCA,DESDES, SUM(CANVEN) AS CANVEN, SUM(VALVEN) AS VALVEN FROM (SELECT DESCO1,DESDES, COALESCE(CANVEN,0) AS CANVEN, COALESCE(VALVEN,0) AS VALVEN FROM LBPRDDAT/DESARC AS DESTABLA LEFT JOIN (SELECT T2.CODCIA, T2.ANOPRO, T2.MESPRO, T2.MARCA, T2.CANVEN,T2.VALVEN FROM LBPRDDAT/LO0703 AS T1 INNER JOIN LBPRDDAT/LO2234 AS T2 ON T1.CODCIA=T2.CODCIA WHERE T1.CODIGO=13 AND T2.ANOPRO=".($ano2)." AND T2.MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." ORDER BY T2.MESPRO ) AS VENTABLA ON DESTABLA.DESCO1=VENTABLA.MARCA WHERE DESCOD=1 AND DESCO1<=950) AS T GROUP BY DESCO1,DESDES ORDER BY DESCO1) AS ANO1 INNER JOIN (SELECT DESCO1 AS MARCA,DESDES, SUM(CANVEN) AS CANVEN, SUM(VALVEN) AS VALVEN FROM (SELECT DESCO1,DESDES, COALESCE(CANVEN,0) AS CANVEN, COALESCE(VALVEN,0) AS VALVEN FROM LBPRDDAT/DESARC AS DESTABLA LEFT JOIN (SELECT T2.CODCIA, T2.ANOPRO, T2.MESPRO, T2.MARCA, T2.CANVEN,T2.VALVEN FROM LBPRDDAT/LO0703 AS T1 INNER JOIN LBPRDDAT/LO2234 AS T2 ON T1.CODCIA=T2.CODCIA WHERE T1.CODIGO=13 AND T2.ANOPRO=".($ano2-1)." AND T2.MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." ORDER BY T2.MESPRO ) AS VENTABLA ON DESTABLA.DESCO1=VENTABLA.MARCA WHERE DESCOD=1 AND DESCO1<=950) AS T GROUP BY DESCO1,DESDES ORDER BY DESCO1) AS ANO2 ON ANO1.MARCA = ANO2.MARCA AND ANO1.DESDES = ANO2.DESDES
) AS COS ON HON.MARCA = COS.MARCA
INNER JOIN (
SELECT ANO1.MARCA,ANO1.DESDES,ANO1.CANVEN AS CANANO1, ANO1.VALVEN AS VALANO1, ANO2.CANVEN AS CANANO2, ANO2.VALVEN AS VALANO2 FROM (SELECT DESCO1 AS MARCA,DESDES, SUM(CANVEN) AS CANVEN, SUM(VALVEN) AS VALVEN FROM (SELECT DESCO1,DESDES, COALESCE(CANVEN,0) AS CANVEN, COALESCE(VALVEN,0) AS VALVEN FROM LBPRDDAT/DESARC AS DESTABLA LEFT JOIN (SELECT T2.CODCIA, T2.ANOPRO, T2.MESPRO, T2.MARCA, T2.CANVEN,T2.VALVEN FROM LBPRDDAT/LO0703 AS T1 INNER JOIN LBPRDDAT/LO2234 AS T2 ON T1.CODCIA=T2.CODCIA WHERE T1.CODIGO=15 AND T2.ANOPRO=".($ano2)." AND T2.MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." ORDER BY T2.MESPRO ) AS VENTABLA ON DESTABLA.DESCO1=VENTABLA.MARCA WHERE DESCOD=1 AND DESCO1<=950) AS T GROUP BY DESCO1,DESDES ORDER BY DESCO1) AS ANO1 INNER JOIN (SELECT DESCO1 AS MARCA,DESDES, SUM(CANVEN) AS CANVEN, SUM(VALVEN) AS VALVEN FROM (SELECT DESCO1,DESDES, COALESCE(CANVEN,0) AS CANVEN, COALESCE(VALVEN,0) AS VALVEN FROM LBPRDDAT/DESARC AS DESTABLA LEFT JOIN (SELECT T2.CODCIA, T2.ANOPRO, T2.MESPRO, T2.MARCA, T2.CANVEN,T2.VALVEN FROM LBPRDDAT/LO0703 AS T1 INNER JOIN LBPRDDAT/LO2234 AS T2 ON T1.CODCIA=T2.CODCIA WHERE T1.CODIGO=15 AND T2.ANOPRO=".($ano2-1)." AND T2.MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." ORDER BY T2.MESPRO ) AS VENTABLA ON DESTABLA.DESCO1=VENTABLA.MARCA WHERE DESCOD=1 AND DESCO1<=950) AS T GROUP BY DESCO1,DESDES ORDER BY DESCO1) AS ANO2 ON ANO1.MARCA = ANO2.MARCA AND ANO1.DESDES = ANO2.DESDES
) AS REP ON HON.MARCA = REP.MARCA
INNER JOIN (
SELECT ANO1.MARCA,ANO1.DESDES,ANO1.CANVEN AS CANANO1, ANO1.VALVEN AS VALANO1, ANO2.CANVEN AS CANANO2, ANO2.VALVEN AS VALANO2 FROM (SELECT DESCO1 AS MARCA,DESDES, SUM(CANVEN) AS CANVEN, SUM(VALVEN) AS VALVEN FROM (SELECT DESCO1,DESDES, COALESCE(CANVEN,0) AS CANVEN, COALESCE(VALVEN,0) AS VALVEN FROM LBPRDDAT/DESARC AS DESTABLA LEFT JOIN (SELECT T2.CODCIA, T2.ANOPRO, T2.MESPRO, T2.MARCA, T2.CANVEN,T2.VALVEN FROM LBPRDDAT/LO0703 AS T1 INNER JOIN LBPRDDAT/LO2234 AS T2 ON T1.CODCIA=T2.CODCIA WHERE T1.CODIGO=16 AND T2.ANOPRO=".($ano2)." AND T2.MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." ORDER BY T2.MESPRO ) AS VENTABLA ON DESTABLA.DESCO1=VENTABLA.MARCA WHERE DESCOD=1 AND DESCO1<=950) AS T GROUP BY DESCO1,DESDES ORDER BY DESCO1) AS ANO1 INNER JOIN (SELECT DESCO1 AS MARCA,DESDES, SUM(CANVEN) AS CANVEN, SUM(VALVEN) AS VALVEN FROM (SELECT DESCO1,DESDES, COALESCE(CANVEN,0) AS CANVEN, COALESCE(VALVEN,0) AS VALVEN FROM LBPRDDAT/DESARC AS DESTABLA LEFT JOIN (SELECT T2.CODCIA, T2.ANOPRO, T2.MESPRO, T2.MARCA, T2.CANVEN,T2.VALVEN FROM LBPRDDAT/LO0703 AS T1 INNER JOIN LBPRDDAT/LO2234 AS T2 ON T1.CODCIA=T2.CODCIA WHERE T1.CODIGO=16 AND T2.ANOPRO=".($ano2-1)." AND T2.MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2." ORDER BY T2.MESPRO ) AS VENTABLA ON DESTABLA.DESCO1=VENTABLA.MARCA WHERE DESCOD=1 AND DESCO1<=950) AS T GROUP BY DESCO1,DESDES ORDER BY DESCO1) AS ANO2 ON ANO1.MARCA = ANO2.MARCA AND ANO1.DESDES = ANO2.DESDES
) AS NIC ON HON.MARCA = NIC.MARCA

10    Pais Guatemala
11    Pais Honduras
12    Pais El Salvador
13    Pais Costa Rica
15    REPUBLICA DOMINICANA
16    NICARAGUA



//TIENDAS INDIVIDUALMENTE:

SELECT MARCA,DESDES,HONCANANO1,HONVALANO1,HONCANANO2,HONVALANO2
FROM (SELECT  ANO1.MARCA, ANO1.DESDES,ANO1.CANANO1 HONCANANO1,ANO1.VALANO1 HONVALANO1,COALESCE(ANO2.CANANO1,0) HONCANANO2,COALESCE(ANO2.VALANO1,0) HONVALANO2
         FROM(SELECT ANO1.MARCA MARCA,ANO1.DESDES,ANO1.CANTIDAD CANANO1,ANO1.VALOR VALANO1 FROM (SELECT MARCA,DESDES,
         FLOOR(((FLOOR(CANTIDAD)*12) +ROUND((CANTIDAD - FLOOR(CANTIDAD)) * 100))) CANTIDAD, VALOR FROM (SELECT MARCA, MAX(DESDES) as DESDES,
         SUM(CANVEN) CANTIDAD, SUM(VALVEN) VALOR FROM (SELECT MARCA, CANVEN, VALVEN FROM LBPRDDAT/lo2234 WHERE ANOPRO=".($ano2)." AND MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2."
          AND CODCIA IN (".$marcaFiltro.")) T1 INNER JOIN LBPRDDAT/DESARC T2 ON T1.MARCA=T2.DESCO1 AND T2.DESCOD=1
           GROUP BY MARCA))ANO1)ANO1  LEFT JOIN (SELECT ANO1.MARCA MARCA,ANO1.DESDES,ANO1.CANTIDAD CANANO1,ANO1.VALOR VALANO1 FROM (SELECT MARCA,DESDES,
         FLOOR(((FLOOR(CANTIDAD)*12) +ROUND((CANTIDAD - FLOOR(CANTIDAD)) * 100))) CANTIDAD, VALOR FROM (SELECT MARCA, MAX(DESDES) as DESDES,
         SUM(CANVEN) CANTIDAD, SUM(VALVEN) VALOR FROM (SELECT  MARCA, CANVEN, VALVEN FROM LBPRDDAT/lo2234 WHERE ANOPRO=".($ano2-1)." AND MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2."
          AND CODCIA IN (".$marcaFiltro.")) T1 INNER JOIN LBPRDDAT/DESARC T2 ON T1.MARCA=T2.DESCO1 AND T2.DESCOD=1   GROUP BY MARCA))ANO1)ANO2 ON  ANO1.MARCA=ANO2.MARCA  ORDER BY MARCA) AS T1 ORDER BY MARCA


MARCA,DESDES,HONCANANO1,HONVALANO1,HONCANANO2,HONVALANO2


SELECT ANO1.MARCA,ANO1.DESDES,ANO1.CANVEN AS HONCANANO1, ANO1.VALVEN AS HONVALANO1, ANO2.CANVEN AS HONCANANO2, ANO2.VALVEN AS HONVALANO2 FROM (SELECT DESCO1 AS MARCA,DESDES, SUM(CANVEN) AS CANVEN, SUM(VALVEN) AS VALVEN FROM (SELECT DESCO1,DESDES, COALESCE(FLOOR(((FLOOR(CANVEN)*12) +ROUND((CANVEN - FLOOR(CANVEN)) * 100))),0) AS CANVEN, COALESCE(VALVEN,0) AS VALVEN FROM LBPRDDAT/DESARC AS DESTABLA LEFT JOIN (SELECT CODCIA,ANOPRO,MESPRO,MARCA,CANVEN,VALVEN FROM LBPRDDAT/LO2234 WHERE CODCIA IN (".$marcaFiltro.") AND ANOPRO=".($ano2)."  AND MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2.") AS VENTABLA ON DESTABLA.DESCO1=VENTABLA.MARCA WHERE DESCOD=1 AND DESCO1<=950) AS T GROUP BY DESCO1,DESDES) AS ANO1 INNER JOIN (SELECT DESCO1 AS MARCA,DESDES, SUM(CANVEN) AS CANVEN, SUM(VALVEN) AS VALVEN FROM (SELECT DESCO1,DESDES, COALESCE(FLOOR(((FLOOR(CANVEN)*12) +ROUND((CANVEN - FLOOR(CANVEN)) * 100))),0) AS CANVEN, COALESCE(VALVEN,0) AS VALVEN FROM LBPRDDAT/DESARC AS DESTABLA LEFT JOIN (SELECT CODCIA,ANOPRO,MESPRO,MARCA,CANVEN,VALVEN FROM LBPRDDAT/LO2234 WHERE CODCIA IN (".$marcaFiltro.") AND ANOPRO=".($ano2-1)."  AND MESPRO BETWEEN ".$mesNum1." AND ".$mesNum2.") AS VENTABLA ON DESTABLA.DESCO1=VENTABLA.MARCA WHERE DESCOD=1 AND DESCO1<=950) AS T GROUP BY DESCO1,DESDES) AS ANO2 ON ANO1.MARCA = ANO2.MARCA AND ANO1.DESDES = ANO2.DESDES
